function Tile(e){this.title=e;this.flipped=false}function Game(e){var t=makeDeck(e);this.grid=makeGrid(t);this.message=Game.MESSAGE_CLICK;this.unmatchedPairs=e.length;this.flipTile=function(e){if(e.flipped){return}e.flip();if(!this.firstPick||this.secondPick){if(this.secondPick){this.firstPick.flip();this.secondPick.flip();this.firstPick=this.secondPick=undefined}this.firstPick=e;this.message=Game.MESSAGE_ONE_MORE}else{if(this.firstPick.title===e.title){this.unmatchedPairs--;this.message=this.unmatchedPairs>0?Game.MESSAGE_MATCH:Game.MESSAGE_WON;this.firstPick=this.secondPick=undefined;if(this.unmatchedPairs==0){$(".message").css("background","red");(function(e,t,n){var r={};(function(t){function a(e,t){function n(i){if(s[e].playing){if(s[e].start==-1)s[e].start=i;t(i-s[e].start+s[e].shift);if(!s[e])return;s[e].frameId=r(n);s[e].lastTime=i}}return n}var r=(e.requestAnimationFrame||e.mozRequestAnimationFrame||e.webkitRequestAnimationFrame||e.msRequestAnimationFrame||function(t){return e.setTimeout(function(){t(Date.now())},1e3/16)}).bind(e);var i=(e.cancelAnimationFrame||e.mozCancelAnimationFrame||e.webkitcancelAnimationFrame||e.mscancelAnimationFrame||e.clearTimeout).bind(e);var s={};var o=0;var u=-1;t.setRender=function(t,n){var i=o,t;n=n||0;o++;s[i]={frameId:0,playing:true,thread:t,lastTime:0,shift:n,start:-1};t=a(i,t);r(t);return i};t.clearRender=function(t){if(s[t]!==n){if(s[t].playing){i(s[t].frameId)}s[t]=n;return true}else{return false}};t._init=function(){function t(){function e(e){u=e}return e}var n=t();r(n)};t._init()})(r);var i=function(){var n=e.getComputedStyle,r,i,s="";if(n){r=n(t.documentElement,"");r=Array.prototype.join.call(r,"");i=r.match(/-(?:O|Moz|webkit|ms)-/i);if(i){s=i[0]}}return s}();var s=t.getElementsByTagName("style")[0],o=t.createElement("style");o.innerHTML=".negi{position:absolute;top:50%;left:50%;z-index:99999;display:block;}.negiSpace{position:fixed;top:0;left:0;bottom:0;right:0;"+i+"transform-origin:50% 50%;transform-origin:50% 50%;"+i+"transform-style:preserve-3d;transform-style:preserve-3d;"+i+"perspective:1000px;perspective:1000px;"+i+"perspective-origin:50% 50%;;perspective-origin:50% 50%;"+i+"pointer-events:none;pointer-events:none;}";if(s===n){s=t.getElementsByTagName("head")[0];s.appendChild(o)}else{if(s.parentNode.lastChild==s){s.parentNode.appendChild(o)}else{s.parentNode.insertBefore(o,s.nextSibling)}}var u,a;u=t.createElement("div");u.setAttribute("class","negiSpace");if(t.getElementsByClassName("negiSpace")){a=t.getElementsByClassName("negiSpace")[0];t.getElementsByTagName("body")[0].insertBefore(u,t.getElementsByTagName("body")[0].nextSilbing)}else{t.getElementsByTagName("body")[0].appendChild(u)}var f=["img/captain1.png","img/captain2.png","img/captain3.png","img/captain4.png","img/captain5.png","img/captain6.png"];var l=function(){function n(){this.requestAnimationFrame=(e.requestAnimationFrame||e.mozRequestAnimationFrame||e.webkitRequestAnimationFrame||e.msRequestAnimationFrame||setTimeout).bind(e);this.cancelAnimationFrame=(e.cancelAnimationFrame||e.mozcancelAnimationFrame||e.webkitcancelAnimationFrame||e.mscancelAnimationFrame||clearTimeout).bind(e);this.__instances=[]}n.prototype.init=function(){this.__instances=[];var e,n;for(var r=-2e3;r<1e3;r+=20){e=t.createElement("img");e.setAttribute("class","negi");e.setAttribute("src",f[Math.ceil(Math.random()*6)-1]);n={};n[i+"transform"]="translate3d("+(Math.random()*1e3-500)+"px, "+(Math.random()*1e3-500)+"px, "+r+"px) rotateZ(1deg)";n["transform"]=n[i+"transform"];n["z-index"]=(89999+r).toString();this.setInlineCSS(e,n);u.insertBefore(e,u.nextSibling);this.__instances.push(e)}};n.prototype.start=function(){this.init();var e=0;var t=function(t){var n=t-e;e=t;var r,s,o,u,a,f=0,l,c=1;for(var h=0;h<this.__instances.length;h++){r=this.__instances[h];s=this.getInlineCSS(r);o=s[i+"transform"]||s["transform"];u=o.match(/translate3d\(([0-9\-.]+)px, ([0-9\-.]+)px, ([0-9\-.]+)px\)/g)[0];a=u.replace("translate3d(","").replace(/px/g,"").replace(")","").split(", ");l=o.match(/rotateZ\([0-9]+deg\)/g)[0];f=parseInt(a[2])+Math.floor(n*2);c=parseInt(l.replace("rotateZ(","").replace(")",""))+Math.floor(n/2);if(f>1e3){f=(f+2e3)%3e3-2e3;a[0]=Math.random()*1e3-500;a[1]=Math.random()*1e3-500}a[2]=f+"px";o=o.replace(u,"translate3d("+a.join("px, ")+")");o=o.replace(l,"rotateZ("+c+"deg)");s={};s[i+"transform"]=o;s["transform"]=s[i+"transform"];s["z-index"]=(89999+f).toString();s["opacity"]=f<-1e3?(f+2e3)/1e3:f>600?(2600-f)/2e3:1;this.setInlineCSS(r,s);this.__instances[h]=r}}.bind(this);r.setRender(t)};n.prototype.getInlineCSS=function(e){if(e.__style){return e.__style}var t=e.getAttribute("style")||"";var n=/([^:\s]+)\s*:\s*([^;]+)/g;var r={};t.replace(n,function(e,t,n){r[t]=n.trim()});e.__style=r;return r};n.prototype.setInlineCSS=function(e,t){var n=this.getInlineCSS(e),r=[],i;for(i in t){if(t.hasOwnProperty(i)){n[i]=t[i]}}for(i in n){if(n.hasOwnProperty(i)){r.push(i+": "+n[i])}}e.setAttribute("style",r.join("; "))};return n}();(new l).start()})(window,document)}}else{this.secondPick=e;this.message=Game.MESSAGE_MISS}}}}function makeDeck(e){var t=[];e.forEach(function(e){t.push(new Tile(e));t.push(new Tile(e))});return t}function makeGrid(e){var t=Math.sqrt(e.length),n=[];for(var r=0;r<t;r++){n[r]=[];for(var i=0;i<t;i++){n[r][i]=removeRandomTile(e)}}return n}function removeRandomTile(e){var t=Math.floor(Math.random()*e.length);return e.splice(t,1)[0]}Tile.prototype.flip=function(){this.flipped=!this.flipped};Game.MESSAGE_CLICK="來來來翻一張，看看偉忠泳褲後面是什麼";Game.MESSAGE_ONE_MORE="來來來，再看看另一條洨褲褲～";Game.MESSAGE_MISS="可惜RRR，再選錯偉忠要噴汁了！";Game.MESSAGE_MATCH="幹得好，繼續試試";Game.MESSAGE_WON='恭喜你淫了！獲得<a href="https://www.facebook.com/photo.php?fbid=1486731391555517&set=a.1478822712346385.1073741828.1478815515680438&type=1&stream_ref=10" target="_blank">偉忠抱枕乙個</a>！腫花民國萬歲！';jQuery.fn.flash=function(e,t){var n=this.css("color");this.animate({color:"rgb("+e+")"},t/2);this.animate({color:n},t/2)}